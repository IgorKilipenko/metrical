# Test Utils

–ü–∞–∫–µ—Ç `testutils` —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤–æ –≤—Å–µ–º –ø—Ä–æ–µ–∫—Ç–µ.

## üì¶ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ

### MockLogger

`MockLogger` - —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `logger.Logger` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö.

#### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- **No-op –æ–ø–µ—Ä–∞—Ü–∏–∏**: –í—Å–µ –º–µ—Ç–æ–¥—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—é—Ç
- **Thread-safe**: –ë–µ–∑–æ–ø–∞—Å–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö
- **–õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π**: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã
- **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–π**: –û–¥–∏–Ω–∞–∫–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤–æ –≤—Å–µ—Ö —Ç–µ—Å—Ç–∞—Ö

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```go
import (
    "github.com/IgorKilipenko/metrical/internal/testutils"
    "github.com/IgorKilipenko/metrical/internal/logger"
)

func TestSomething(t *testing.T) {
    // –°–æ–∑–¥–∞–µ–º –º–æ–∫ –ª–æ–≥–≥–µ—Ä
    mockLogger := testutils.NewMockLogger()
    
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–º –∫–æ–¥–µ
    service := service.NewMetricsService(repository, mockLogger)
    
    // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å...
}
```

### TestFilePaths

`TestFilePaths` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Å –ø—É—Ç—è–º–∏ –∫ —Ç–µ—Å—Ç–æ–≤—ã–º —Ñ–∞–π–ª–∞–º –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö.

#### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã:
- `TestMetricsFile` - –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –º–µ—Ç—Ä–∏–∫ (`/tmp/test-metrics.json`)
- `TestSyncFile` - –¥–ª—è —Ç–µ—Å—Ç–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (`/tmp/test-sync-metrics.json`)
- `TestEnvFile` - –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (`/tmp/test-env-metrics.json`)
- `TestFlagFile` - –¥–ª—è —Ç–µ—Å—Ç–æ–≤ CLI —Ñ–ª–∞–≥–æ–≤ (`/tmp/test-flag-metrics.json`)

#### –§—É–Ω–∫—Ü–∏–∏:
- `GetTestFilePath(name string)` - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—É—Ç—å –∫ —Ç–µ—Å—Ç–æ–≤–æ–º—É —Ñ–∞–π–ª—É —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º –∏–º–µ–Ω–µ–º

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```go
import "github.com/IgorKilipenko/metrical/internal/testutils"

func TestRepository(t *testing.T) {
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—É—é –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É
    repo := repository.NewInMemoryMetricsRepository(
        testutils.NewMockLogger(), 
        testutils.TestMetricsFile, 
        false,
    )
    
    // –ò–ª–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—É—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
    customFile := testutils.GetTestFilePath("custom")
    // –†–µ–∑—É–ª—å—Ç–∞—Ç: "/tmp/test-custom-metrics.json"
}
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **DRY –ø—Ä–∏–Ω—Ü–∏–ø**: –ò–∑–±–µ–≥–∞–µ–º –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞ –≤ —Ç–µ—Å—Ç–∞—Ö
2. **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –û–¥–∏–Ω–∞–∫–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–æ–∫–∞ –≤–æ –≤—Å–µ—Ö —Ç–µ—Å—Ç–∞—Ö
3. **–ü—Ä–æ—Å—Ç–æ—Ç–∞**: –õ–µ–≥–∫–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –ø–æ–Ω–∏–º–∞—Ç—å
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è

–î–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤:

1. –ó–∞–º–µ–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è `MockLogger` –Ω–∞ –∏–º–ø–æ—Ä—Ç `testutils`
2. –ó–∞–º–µ–Ω–∏—Ç—å `newMockLogger()` –Ω–∞ `testutils.NewMockLogger()`
3. –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥

### –ü—Ä–∏–º–µ—Ä –º–∏–≥—Ä–∞—Ü–∏–∏:

**–î–æ:**
```go
// MockLogger –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
type MockLogger struct{}

func (m *MockLogger) SetLevel(level logger.LogLevel) {}
// ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã

func newMockLogger() logger.Logger {
    return &MockLogger{}
}

func TestSomething(t *testing.T) {
    mockLogger := newMockLogger()
    // ...
}
```

**–ü–æ—Å–ª–µ:**
```go
import "github.com/IgorKilipenko/metrical/internal/testutils"

func TestSomething(t *testing.T) {
    mockLogger := testutils.NewMockLogger()
    // ...
}
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
internal/
‚îú‚îÄ‚îÄ testutils/
‚îÇ   ‚îú‚îÄ‚îÄ logger.go      # MockLogger –∏ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ files.go       # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ README.md      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ ...
```

## üìù –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

–í –±—É–¥—É—â–µ–º –ø–∞–∫–µ—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω:
- Mock –¥–ª—è –¥—Ä—É–≥–∏—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
- –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –•–µ–ª–ø–µ—Ä—ã –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –±–µ–Ω—á–º–∞—Ä–∫–æ–≤
