{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Build Agent",
            "type": "shell",
            "command": "go",
            "args": [
                "build",
                "-o",
                "cmd/agent/agent",
                "cmd/agent/main.go",
                "cmd/agent/cli.go"
            ],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": [
                "$go"
            ],
            "detail": "Сборка агента метрик"
        },
        {
            "label": "Build Server",
            "type": "shell",
            "command": "go",
            "args": [
                "build",
                "-o",
                "cmd/server/server",
                "cmd/server/main.go",
                "cmd/server/cli.go",
                "cmd/server/cliutils.go"
            ],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": [
                "$go"
            ],
            "detail": "Сборка сервера метрик"
        },
        {
            "label": "Build All",
            "type": "shell",
            "command": "go",
            "args": [
                "build",
                "-o",
                "cmd/agent/agent",
                "cmd/agent/main.go",
                "cmd/agent/cli.go"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": [
                "$go"
            ],
            "detail": "Сборка агента и сервера",
            "dependsOrder": "sequence",
            "dependsOn": [
                "Build Agent",
                "Build Server"
            ]
        },
        {
            "label": "Run Auto Tests Iteration4",
            "type": "shell",
            "command": "../auto-tests/metricstest",
            "args": [
                "-test.v",
                "-test.run=^TestIteration4$",
                "-binary-path=cmd/server/server",
                "-agent-binary-path=cmd/agent/agent",
                "-source-path=.",
                "-server-port=9091"
            ],
            "group": "test",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": [],
            "detail": "Запуск автотестов для Iteration4",
            "dependsOn": "Build All"
        },
        {
            "label": "Run Auto Tests Iteration5",
            "type": "shell",
            "command": "../auto-tests/metricstest",
            "args": [
                "-test.v",
                "-test.run=^TestIteration5$",
                "-binary-path=cmd/server/server",
                "-agent-binary-path=cmd/agent/agent",
                "-source-path=.",
                "-server-port=9091"
            ],
            "group": "test",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": [],
            "detail": "Запуск автотестов для Iteration5",
            "dependsOn": "Build All"
        },
        {
            "label": "Run All Auto Tests",
            "type": "shell",
            "command": "../auto-tests/metricstest",
            "args": [
                "-test.v",
                "-binary-path=cmd/server/server",
                "-agent-binary-path=cmd/agent/agent",
                "-source-path=.",
                "-server-port=9091"
            ],
            "group": "test",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": [],
            "detail": "Запуск всех автотестов",
            "dependsOn": "Build All"
        },
        {
            "label": "Run All Tests",
            "type": "shell",
            "command": "go",
            "args": [
                "test",
                "./...",
                "-v"
            ],
            "group": "test",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": [
                "$go"
            ],
            "detail": "Запуск всех unit тестов"
        },
        {
            "label": "Run Tests with Coverage",
            "type": "shell",
            "command": "go",
            "args": [
                "test",
                "./...",
                "-v",
                "-cover"
            ],
            "group": "test",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": [
                "$go"
            ],
            "detail": "Запуск тестов с покрытием"
        },
        {
            "label": "Full Test Suite",
            "type": "shell",
            "command": "echo",
            "args": [
                "Running full test suite..."
            ],
            "group": {
                "kind": "test",
                "isDefault": true
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": [],
            "detail": "Полный набор тестов (unit + автотесты)",
            "dependsOrder": "sequence",
            "dependsOn": [
                "Run All Tests",
                "Run Auto Tests"
            ]
        },
        {
            "label": "Clean Build",
            "type": "shell",
            "command": "go",
            "args": [
                "clean"
            ],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": [],
            "detail": "Очистка сборки"
        },
        {
            "label": "Run Server",
            "type": "shell",
            "command": "cmd/server/server",
            "args": [
                "-a=localhost:9090"
            ],
            "group": "none",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": [],
            "detail": "Запуск сервера на localhost:9090",
            "dependsOn": "Build Server"
        },
        {
            "label": "Run Agent",
            "type": "shell",
            "command": "cmd/agent/agent",
            "args": [
                "-a=localhost:8080",
                "-r=2s"
            ],
            "group": "none",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": [],
            "detail": "Запуск агента на localhost:8080 с интервалом 2с",
            "dependsOn": "Build Agent"
        }
    ]
}
